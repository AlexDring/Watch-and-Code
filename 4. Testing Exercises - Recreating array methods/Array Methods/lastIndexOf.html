<script src="../simpletest.js"></script>
<script>
  /**
   * The lastIndexOf() method returns the last index at which a given element can be found in the array, or -1 if it is not present. 
   * The array is searched backwards, starting at fromIndex.
   */

  // Examples:
  // const animals = ['Dodo', 'Tiger', 'Penguin', 'Dodo'];

  // console.log(animals.lastIndexOf('Dodo'));
  // // expected output: 3

  // console.log(animals.lastIndexOf('Tiger'));
  // // expected output: 1

  // Function signature:
  // arr.lastIndexOf(searchElement[, fromIndex])
  // will be recreated as:
  // function lastIndexOf(array, searchElement[, fromIndex])

  /**
  * Parameters:
  * 
  // searchElement - Element to locate in the array.
  // fromIndex Optional - The index at which to start searching backwards. Defaults to the array's length minus one (arr.length - 1), i.e. the whole array will be searched. If the index is greater than or equal to the length of the array, the whole array will be searched. If negative, it is taken as the offset from the end of the array. Note that even when the index is negative, the array is still searched from back to front. If the calculated index is less than 0, -1 is returned, i.e. the array will not be searched.

  // Return Value:
  // The last index of the element in the array; -1 if not found.
  * 
  * */

  function lastIndexOf(array, searchElement, optionalFromIndex = (array.length - 1)) {
    var startingIndex = optionalFromIndex;

    if (optionalFromIndex < 0) {
      startingIndex = array.length + optionalFromIndex;
    }

    for (let i = startingIndex; i >= 0; i--) {
      // If current element is equal to the searchElement 
      if (array[i] === searchElement) {
        // return position
        return i;
      }
    }
    return -1;
  }

  tests({

    'It should return the last index at which a given element can be found in the array': function () {
      var returnedIndex = lastIndexOf([1, 2, 3, 4, 1, 1, 1, 1], 1);
      eq(returnedIndex, 7)
    },
    'It should return -1 if the given element can not be found in the array': function () {
      var returnedIndex = lastIndexOf([1, 2, 3, 4, 1, 1, 1, 1], 52);
      eq(returnedIndex, -1)
    },
    'It should search the array backwards, starting at fromIndex.': function () {
      var originalArray = [1, 2, 3, 4, 1, 1, 1, 1];
      var returnedIndex = lastIndexOf(originalArray, 1);
      eq(returnedIndex, 7)
    },
    'It should return search the whole array if the index is greater than or equal to the length of the array': function () {
      var originalArray = [5, 2, 3, 4, 1, 1, 1, 1];
      var returnedIndex = lastIndexOf(originalArray, 5, 9);
      eq(returnedIndex, 0)
    },
    'If the fromIndex is negative, it should be taken as the offset from the end of the array.': function () {
      var animals = ['cat', 'dog', 'dog', 'cat', 'pig', 'cat'];
      var returnedIndex = lastIndexOf(animals, 'cat', -4)
      eq(returnedIndex, 0)
    },
    'It should return -1 if the calculated index (optionalFromIndex = (array.length - 1)) is less than 0, i.e. the array will not be searched.': function () {
      var animals = [];
      var returnedIndex = lastIndexOf(animals, 'cat')
      eq(returnedIndex, -1)
    }
  });
</script>